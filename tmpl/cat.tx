<!doctype html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <script src="<: uri_for('/static/js/jquery-3.5.0.min.js') :>"></script>
        <link href="<: uri_for('/static/bootstrap/css/bootstrap.css') :>" rel="stylesheet" type="text/css" />
        <script src="<: uri_for('/static/bootstrap/js/bootstrap.js') :>"></script>
        <script src="<: uri_for('/static/js/es5-shim.min.js') :>"></script>
        <script src="<: uri_for('/static/js/micro_template.js') :>"></script>
        <script src="<: uri_for('/static/js/strftime.js') :>"></script>
        <script src="<: uri_for('/static/js/sprintf.js') :>"></script>
        <script src="<: uri_for('/static/js/micro-location.js') :>"></script>
        <script src="<: uri_for('/static/js/micro_dispatcher.js') :>"></script>
        <script src="<: uri_for('/static/js/xsrf-token.js') :>"></script>
        <link href="<: static_file('/static/css/main.css') :>" rel="stylesheet" type="text/css" media="screen" />
        <script src="<: static_file('/static/js/main.js') :>"></script>
        <!--[if lt IE 9]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
    </head>
    <body>
        <script type="text/javascript">
            function moveBottom() {
                const psconsole = $('#console');
                psconsole.scrollTop(
                    psconsole[0].scrollHeight - psconsole.height()
                );
            }

            $(document).ready(function() {
                moveBottom();
            });

            $(function(){
                setInterval(function(){
                    $.get('/tail', function (data) {
                        if (data.lines !== 0) {
                            const logArea = $('#console');
                            let log = logArea.val();
                            console.log('現在のログ' + log)
                            logArea.val(log + data.diff);
                            console.log('acted');
                        }
                    });
                },1000);
            });
        </script>
        <div class="container">
            <p>cat result is here.</p>
            <textarea readonly id="console" rows="30" cols="100"><: $cat :></textarea>
        </div>
    </body>
</html>

